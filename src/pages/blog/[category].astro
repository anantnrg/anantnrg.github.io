---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { categoryData } from "../categories.ts";

export async function getStaticPaths() {
    const posts = await getCollection("blog");

    const categories = [
        ...new Set(posts.map((post) => post.data.category).filter(Boolean)),
    ];

    return categories.map((category) => ({
        params: { category },
        props: {
            category,
            posts: posts.filter((post) => post.data.category === category),
        },
    }));
}

const { category, posts } = Astro.props;
---

<Layout>
    <h1
        class="text-accent font-ocra flex items-center justify-center text-4xl text-center px-4"
    >
        {categoryData[category]?.name || category}
    </h1>
    <div
        set:html={categoryData[category]?.desc || ""}
        class="max-w-3xl font-space mx-auto prose prose-lg dark:prose-invert my-4 text-justify px-4"
    />
    <div
        class="w-full h-auto flex items-center flex-wrap gap-4 px-6 max-w-3xl mx-auto"
    >
        {
            posts.map((post, _) => (
                <a href={`/blog/${category}/${post.slug}`} class="block">
                    <div class="w-60 h-60 px-3 py-3 border-1 border-grey/40 rounded-lg font-space text-lg font-medium hover:text-accent hover:border-accent hover:drop-shadow-lg transition-all cursor-pointer flex flex-col text-center items-center justify-center  backdrop-blur-xs gap-2">
                        <h3 class="text-xl">{post.data.title}</h3>
                        <p class="text-base">{post.data.desc}</p>
                    </div>
                </a>
            ))
        }
    </div>
</Layout>
