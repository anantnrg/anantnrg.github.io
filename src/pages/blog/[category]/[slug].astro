---
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
    const posts = await getCollection("blog");

    return posts.map((post) => {
        if (!post.data.category) {
            console.warn(`[WARN] Missing category in post: ${post.slug}`);
        }
        return {
            params: {
                category: post.data.category || "uncategorized", // Fallback category
                slug: post.slug,
            },
            props: { post },
        };
    });
}

const { Content } = await render(Astro.props.post); // Properly render Markdown
---

<html>
    <head>
        <title>{Astro.props.post.data.title}</title>
    </head>
    <body>
        <h1>{Astro.props.post.data.title}</h1>
        <p>{Astro.props.post.data.description}</p>
        <article>
            <Content />
        </article>
    </body>
</html>
